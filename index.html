import { Client } from "@gradio/client";

async function runPrediction() {
    // Fetch an example image (this would be replaced by the user's uploaded image in practice)
    const response_0 = await fetch("https://raw.githubusercontent.com/gradio-app/gradio/main/test/test_files/bus.png");
    const exampleImage = await response_0.blob();
    
    // Instantiate the client for your Hugging Face Space
    const client = new Client("https://sakibrumu-food-image-classification5.hf.space/");

    // Send the image to the Gradio app for prediction
    const result = await client.predict("/predict", {
        data: [exampleImage]
    });

    // Log the prediction result
    console.log(result.data);

    // Get prediction label and probabilities (adjust according to the response format)
    const pred_label = result.data[0].label;
    const predictions = result.data[0].predictions;

    // Display the result and the uploaded image in the DOM
    document.getElementById("results").innerHTML = `
        <p><strong>Prediction:</strong> ${pred_label}</p>
        <p><strong>Probabilities:</strong></p>
        <pre>${JSON.stringify(predictions, null, 2)}</pre>
        <img src="${URL.createObjectURL(exampleImage)}" width="500">
    `;
}

runPrediction().catch(console.error);
